function InterplayCalendar(a,c,d,b,e){this.instance=a;this.calendar_id=c;this.details_id=d;this.calendarElem=null;this.detailsElem=null;this.date=b;this.currentDate=new Date();this.visibleDate=null;this.selectedDate=null;this.monthArray=new Array("January","February","March","April","May","June","July","August","September","October","November","December");this.dayArray=new Array("S","M","T","W","T","F","S");this.init=function(){this.calendarElem=document.getElementById(c);this.detailsElem=document.getElementById(d);this.selectDate(this.date)};this.buildCalendar=function(){var q=document.createElement("table");var l=document.createElement("thead");var g=document.createElement("tbody");var n=document.createElement("tfoot");var f=null;var m=null;var r=null;var j=true;var o=false;var p=null;var k=null;var h=new Date(this.visibleDate);h.setDate(1);this.calendarElem.innerHTML="";for(p=1;p<=9;p++){f=document.createElement("tr");if(p==1){m=document.createElement("th");this.addClass(m,"calendar-month");m.setAttribute("colspan","7");r=document.createTextNode(this.monthArray[this.visibleDate.getMonth()]+" "+this.visibleDate.getFullYear());m.appendChild(r);f.appendChild(m)}else{if(p==9){for(k=1;k<=3;k++){m=document.createElement("td");switch(k){case 1:this.addClass(m,"calendar-prev");m.setAttribute("colspan","3");m.innerHTML='<a href="javascript:;" onclick="'+this.instance+'.prevMonth();">p</a>';break;case 2:m.innerHTML="&nbsp;";break;case 3:this.addClass(m,"calendar-next");m.setAttribute("colspan","3");m.innerHTML='<a href="javascript:;" onclick="'+this.instance+'.nextMonth();">n</a>';break}f.appendChild(m)}}else{for(k=0;k<=6;k++){if(p==2){m=document.createElement("th");this.addClass(m,"calendar-days");r=document.createTextNode(this.dayArray[k]);m.appendChild(r)}else{if(!j&&!o&&h.getMonth()!=this.visibleDate.getMonth()){o=true}else{if(j&&h.getDate()==1){j=false}}m=document.createElement("td");if(k==0||k==6){this.addClass(m,"weekend")}if(h.getDay()==k){if(!j&&!o){if(h.getFullYear()==this.currentDate.getFullYear()&&h.getMonth()==this.currentDate.getMonth()&&h.getDate()==this.currentDate.getDate()){this.addClass(m,"current-date")}if(h.getFullYear()==this.selectedDate.getFullYear()&&h.getMonth()==this.selectedDate.getMonth()&&h.getDate()==this.selectedDate.getDate()){this.addClass(m,"selected-date")}m.innerHTML='<a href="javascript:;" onclick="'+this.instance+".selectDate('"+h.getFullYear()+"-"+(h.getMonth()+1)+"-"+h.getDate()+"');\">"+h.getDate()+"</a>"}else{m.innerHTML="&nbsp;"}h.setDate(h.getDate()+1)}else{m.innerHTML="&nbsp;"}}f.appendChild(m)}}}switch(p){case 1:l.appendChild(f);break;case 2:l.appendChild(f);break;default:g.appendChild(f);break;case 9:n.appendChild(f);break}}q.appendChild(l);q.appendChild(g);q.appendChild(n);this.calendarElem.appendChild(q)};this.selectDate=function(f){this.selectedDate=new Date(f);this.buildDetails();this.showDate(f)};this.showDate=function(f){this.visibleDate=new Date(f);this.buildCalendar()};this.buildDetails=function(){this.detailsElem.innerHTML=this.selectedDate};this.nextMonth=function(){var f="";if((this.visibleDate.getMonth()+1)>11){f=(this.visibleDate.getFullYear()+1)+"-01-01"}else{f=this.visibleDate.getFullYear()+"-"+(this.visibleDate.getMonth()+2)+"-01"}this.showDate(f)};this.prevMonth=function(){var f="";if(this.visibleDate.getMonth()==0){f=(this.visibleDate.getFullYear()-1)+"-12-01"}else{f=this.visibleDate.getFullYear()+"-"+this.visibleDate.getMonth()+"-01"}this.showDate(f)};this.addClass=function(h,g){var f=true;var i="";if(h.getAttribute("class")==null||h.getAttribute("class")==""){h.setAttribute("class","")}else{f=false;i=h.getAttribute("class")}if(!f){i=i+" "}i=i+g;h.setAttribute("class",i)}};